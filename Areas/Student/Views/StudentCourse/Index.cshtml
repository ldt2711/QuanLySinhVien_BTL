@model IEnumerable<QuanLySinhVien_BTL.Models.Course>
@{
    ViewData["Title"] = "Đăng ký học phần";
    Layout = "~/Areas/Student/Views/Shared/_Layout.cshtml";
    var registered = ViewBag.RegisteredCourses as List<QuanLySinhVien_BTL.Models.Course>;
}

<div class="container mt-4">
    <h2 class="text-primary mb-3">Đăng ký học phần</h2>

    @if (TempData["Message"] != null)
    {
        <div class="alert alert-info">@TempData["Message"]</div>
    }

    <!-- Học phần có thể đăng ký -->
    <h4 class="text-success mt-4 mb-3">Các học phần có thể đăng ký</h4>
    <div class="row g-4">
        @if (Model.Any())
        {
            @foreach (var course in Model)
            {
                <div class="col-12 col-md-6 col-lg-4">
                    <div class="card shadow-sm border-0 h-100">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title text-primary">@course.CourseName</h5>
                            <h6 class="card-subtitle mb-2 text-muted">Mã học phần: @course.CourseId</h6>

                            <ul class="list-unstyled mt-3 mb-4 small">
                                <li><strong>Giảng viên:</strong> @(course.Lecturer?.Name ?? "Chưa có")</li>
                                <li><strong>Ngành:</strong> @(course.Major?.Name ?? "Không xác định")</li>
                            </ul>

                            <form asp-action="Register" method="post" class="mt-auto">
                                <input type="hidden" name="courseId" value="@course.CourseId" />
                                <button type="submit" class="btn btn-success w-100">
                                    <i class="bi bi-plus-circle"></i> Đăng ký học phần
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <p class="text-muted">Không còn học phần nào để đăng ký.</p>
        }
    </div>

    <hr class="my-5" />

    <!-- Học phần đã đăng ký -->
    <h4 class="text-primary mt-4 mb-3">Các học phần đã đăng ký</h4>
    <div class="row g-4">
        @if (registered != null && registered.Any())
        {
            @foreach (var course in registered)
            {
                <div class="col-12 col-md-6 col-lg-4">
                    <div class="card border border-primary shadow-sm h-100">
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">@course.CourseName</h5>
                            <h6 class="card-subtitle mb-2 text-muted">Mã học phần: @course.CourseId</h6>
                            <ul class="list-unstyled mt-3 mb-4 small">
                                <li><strong>Giảng viên:</strong> @(course.Lecturer?.Name ?? "Chưa có")</li>
                                <li><strong>Ngành:</strong> @(course.Major?.Name ?? "Không xác định")</li>
                            </ul>

                            <form asp-action="Unregister" method="post" class="mt-auto">
                                <input type="hidden" name="courseId" value="@course.CourseId" />
                                <button type="submit" class="btn btn-outline-danger w-100">
                                    <i class="bi bi-x-circle"></i> Hủy đăng ký
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <p class="text-muted">Bạn chưa đăng ký học phần nào.</p>
        }
    </div>
</div>
